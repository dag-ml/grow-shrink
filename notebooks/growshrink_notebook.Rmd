---
title: "Growshrink_Rnotebook"
output: html_notebook
---

This R notebook aims to explore the potential applications of [grow-shrink](https://doi.org/10.48550/arXiv.1407.8088)

This notebook utilizes the bnlearn library for its implementation of growshrink.

```{r}
library(bnlearn)
library(dplyr)
library(Rgraphviz)
```

Getting the data from csv files stored locally on device

```{r}
# Dubee
path_lsds_15 <- file.choose()
data_lsds_15 <- read.csv(path_lsds_15, header = FALSE, skip = 1)
```

```{r}
# Keune 2015
path_lsds_9 <- file.choose()
data_lsds_9 <- read.csv(path_lsds_9, header = FALSE, skip = 1)
```

```{r}
# Keune 2016
path_lsds_30 <- file.choose()
data_lsds30 <- read.csv(path_lsds_30, header = FALSE, skip = 1)
```

```{r}
# Ko 2020 1 of 2
path_lsds_41 <- file.choose()
data_lsds41 <- read.csv(path_lsds_41, header = FALSE, skip = 1)
```

```{r}
# Ko 2020 2 of 2
# micro ct
path_mct_lsds_40 <- file.choose()
# histomorphometry
path_hist_lsds_40 <- file.choose()
# bone
path_bone_lsds_40 <- file.choose()

data_mct_lsds_40 <- read.csv(path_mct_lsds_40, header = FALSE, skip = 1)
data_hist_lsds40 <- read.csv(path_hist_lsds_40, header = FALSE, skip = 1)
data_bone_lsds40 <- read.csv(path_bone_lsds_40, header = FALSE, skip = 1)
```

To start, remove the columns that are not numeric data (uid & filename),
Cast V3 column's "Baseline, Vivarium, Flight, Ground Control to ints (1-4),
and then convert it to a dataframe.

```{r}
data_lsds_15 <- subset(data_lsds_15, select = -(1:2))
data_lsds_15$V3 <- as.numeric(factor(data_lsds_15$V3, levels = unique(data_lsds_15$V3)))
```

```{r}
data_lsds_15
```


Looks good! Just remove the first three columns and then let's run growshrink.

```{r}
dag <- bnlearn::gs(data_lsds_15)
```


```{r}
graph_dag <- bnlearn::as.graphNEL(dag)

plot(graph_dag)
```

Now checking what it looks like without the enumeration of the Factor Value
```{r}
data_lsds_15 <- subset(data_lsds_15, select = -(1:1))
data_lsds_15
```
```{r}
dag <- bnlearn::gs(data_lsds_15)
```


```{r}
graph_dag <- bnlearn::as.graphNEL(dag)

plot(graph_dag)
```
